package cc.unknown.module.impl.exploit;

import java.util.Arrays;
import java.util.stream.Collectors;

import cc.unknown.event.impl.EventLink;
import cc.unknown.event.impl.netty.PacketEvent;
import cc.unknown.mixin.interfaces.network.packets.IC01PacketChatMessage;
import cc.unknown.module.impl.Module;
import cc.unknown.module.impl.api.Category;
import cc.unknown.module.impl.api.Register;
import net.minecraft.network.play.client.C01PacketChatMessage;

@Register(name = "ChatBypass", category = Category.Exploit)
public class ChatBypass extends Module {


	@EventLink
	public void onPacket(PacketEvent e) {
		if (!e.isSend()) return;
		if (e.getPacket() instanceof C01PacketChatMessage) {
			C01PacketChatMessage c01 = (C01PacketChatMessage) e.getPacket();
			String message = c01.getMessage();
			if (!Arrays.stream(new String[]{"/", "!"}).anyMatch(message::startsWith)) {
				String m = Arrays.stream(message.split(" ")).map(word -> "y" + word).collect(Collectors.joining(" "));
				((IC01PacketChatMessage) c01).setMessage(m);
				e.setPacket(c01);
			}
		}
	}
}
